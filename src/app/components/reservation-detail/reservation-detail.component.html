<div class="reservation-detail">
  <form [formGroup]="reservationForm" (ngSubmit)="onSubmit()">
    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Utilisateur</mat-label>
      <mat-select formControlName="userId">
        <mat-option *ngFor="let user of users" [value]="user.id">{{ user.name }}</mat-option>
      </mat-select>
      @if(reservationForm.get('userId')?.hasError('required')) {
        <mat-error>Utilisateur obligatoire</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Terrain</mat-label>
      <mat-select formControlName="courtId">
        <mat-option *ngFor="let court of courts" [value]="court.id">{{ court.name }}</mat-option>
      </mat-select>
      @if(reservationForm.get('courtId')?.hasError('required')) {
        <mat-error>Terrain obligatoire</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Nombre de réservations</mat-label>
      <input matInput type="number" formControlName="reservation" placeholder="1">
      <mat-icon matPrefix>event</mat-icon>
      @if(reservationForm.get('reservation')?.hasError('required')) {
        <mat-error>Nombre obligatoire</mat-error>
      }
      @if(reservationForm.get('reservation')?.hasError('min')) {
        <mat-error>Minimum 1 réservation</mat-error>
      }
    </mat-form-field>

    @if(!loading) {
      <div class="actions">
        <div class="left-actions">
          @if(mode !== 'create' && reservation) {
            <button mat-raised-button color="warn" type="button" (click)="onDelete()">
              <mat-icon>delete</mat-icon> Supprimer
            </button>
          }
        </div>

        <div class="right-actions">
          @if(mode !== 'create' && !isEditMode) {
            <button mat-raised-button color="primary" type="button" (click)="toggleEditMode()">
              <mat-icon>edit</mat-icon> Modifier
            </button>
          }

          @if(isEditMode && mode !== 'create') {
            <button mat-button type="button" class="cancel-button" (click)="toggleEditMode()">Annuler</button>
          }

          @if(isEditMode || mode === 'create') {
            <button mat-raised-button color="primary" type="submit" [disabled]="reservationForm.invalid">
              <mat-icon>{{ mode === 'create' ? 'add' : 'save' }}</mat-icon>
              {{ mode === 'create' ? 'Créer' : 'Enregistrer' }}
            </button>
          }
        </div>
      </div>
    } @else {
      <div class="loading-overlay">
        <mat-spinner diameter="40"></mat-spinner>
      </div>
    }
  </form>
</div>
